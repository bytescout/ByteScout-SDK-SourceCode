//*******************************************************************************************//
//                                                                                           //
// Get Your API Key: https://app.pdf.co/signup                                               //
// API Documentation: https://developer.pdf.co/api/index.html                                //
//                                                                                           //
// Note: Replace placeholder values in the code with your API Key                            //
// and file paths (if applicable)                                                            //
//                                                                                           //
//*******************************************************************************************//


/*
 * Bytescout PDF Generator SDK for Javascript 1.16.153.
 * All rights reserved. Copyright (c) ByteScout 2011-2016, last updated March 31, 2016.
 * http://www.bytescout.com
 * Free for non-commercial use. To purchase commercial license please visit  
 * http://bytescout.com/products/developer/pdfgeneratorsdkjs/index.html
 * Use on commercial sites or for commercial purposes is prohibited without a purchase license.
 */

function BytescoutPDFFatalError(){Error.apply(this,arguments);this.name="BytescoutPDFFatalError"}BytescoutPDFFatalError.prototype=Object.create(Error.prototype);
function BytescoutPDF(){this.ForceJPEGForImages=this.showBytescoutLink=this.stopOnInvalidImages=!0;this.JPEGQuality=.95;this.private_objects=[];this.private_info=this.private_add(new PDFInfo);this.private_catalog=this.private_add(new PDFCatalog);this.private_pages=this.private_add(new PDFPages);this.private_outlines=this.private_add(new PDFOutlines);this.private_catalog.setPages(this.private_pages);this.private_catalog.setOutline(this.private_outlines);this.private_anchors=[];this.private_currentPage=
void 0;this.private_pageWidth=BytescoutPDF.private_PageSizes[BytescoutPDF.A4].w;this.private_pageHeight=BytescoutPDF.private_PageSizes[BytescoutPDF.A4].h;this.private_isPortrait=!0;this.private_box=void 0;this.private_padding={left:0,top:0,right:0,bottom:0};this.private_textAlign=0;this.private_interline=2;this.private_textState=new PDFTextState;this.private_fonts=[];this.private_lineColor=new PDFColor(0,0,0);this.private_lineWidth="1";this.private_lineEndType=0;this.private_alpha=1;this.private_images=
[];this.private_imageIndex=-1;this.private_imageBackgroundColor=new PDFColor(255,255,255);this.private_onHeader=this.private_onFooter=void 0}BytescoutPDF.CRLF="\r\n";BytescoutPDF.A0=0;BytescoutPDF.A1=1;BytescoutPDF.A2=2;BytescoutPDF.A3=3;BytescoutPDF.A4=4;BytescoutPDF.A5=5;BytescoutPDF.A6=6;BytescoutPDF.A7=7;BytescoutPDF.Letter=8;BytescoutPDF.Legal=9;BytescoutPDF.Executive=10;BytescoutPDF.JisB5=11;
BytescoutPDF.private_PageSizes=[{w:33.125,h:46.75},{w:23.375,h:33.125},{w:16.5,h:23.375},{w:11.75,h:16.5},{w:8.25,h:11.75},{w:5.875,h:8.25},{w:4.125,h:5.875},{w:2.875,h:4.125},{w:8.5,h:11},{w:8.5,h:14},{w:7.25,h:10.5},{w:7.125,h:10.125}];BytescoutPDF.prototype.private_add=function(a){this.private_objects.push(a);a.id=this.private_objects.length;return a};BytescoutPDF.prototype.pageSetSize=function(a){a=BytescoutPDF.private_PageSizes[a];this.private_pageWidth=a.w;this.private_pageHeight=a.h};
BytescoutPDF.prototype.pageSetWidth=function(a){this.private_pageWidth=a};BytescoutPDF.prototype.pageSetHeight=function(a){this.private_pageHeight=a};BytescoutPDF.PORTRAIT=0;BytescoutPDF.LANDSCAPE=1;BytescoutPDF.prototype.pageSetOrientation=function(a){this.private_isPortrait=a==BytescoutPDF.PORTRAIT};BytescoutPDF.prototype.onFooter=function(a){this.private_onFooter=a};BytescoutPDF.prototype.onHeader=function(a){this.private_onHeader=a};
BytescoutPDF.prototype.pageAdd=function(){this.private_currentPage=new PDFPage(this,this.private_pageWidth,this.private_pageHeight,this.private_isPortrait,this.private_pages);this.private_add(this.private_currentPage);this.private_pages.addPage(this.private_currentPage);var a=new PDFStream;this.private_add(a);this.private_currentPage.setStream(a);void 0!==this.private_onHeader&&this.private_onHeader(this)};BytescoutPDF.prototype.private_pageSetCurrent=function(a){this.private_currentPage=a};
BytescoutPDF.prototype.pageSetIndex=function(a){this.private_currentPage=this.private_pages.getPage(a-1)};BytescoutPDF.prototype.pageGetIndex=function(){return this.private_pages.getIndex(this.private_currentPage)+1};BytescoutPDF.prototype.pageGetCount=function(){return this.private_pages.getCount()};BytescoutPDF.prototype.propertiesSet=function(a,b,c,d,e){this.private_info.set(a,b,c,d,e)};BytescoutPDF.prototype.fontSetName=function(a){this.private_textState.fontSetName(a)};
BytescoutPDF.prototype.fontSetSize=function(a){this.private_textState.fontSetSize(a)};BytescoutPDF.prototype.fontSetStyle=function(a,b,c){this.private_textState.fontSetStyle(a,b,c)};BytescoutPDF.prototype.fontSetStyle=function(a,b,c,d){this.private_textState.fontSetStyle(a,b,c,d)};BytescoutPDF.prototype.fontSetColor=function(a,b,c){this.private_textState.setColor(new PDFColor(a,b,c))};BytescoutPDF.LEFT=0;BytescoutPDF.JUSTIFIED=1;BytescoutPDF.RIGHT=2;BytescoutPDF.CENTER=3;
BytescoutPDF.prototype.textSetAlign=function(a){this.private_textAlign=a;void 0!==this.private_box&&this.private_box.setAlign(a)};BytescoutPDF.prototype.setInterline=function(a){this.private_interline=a;void 0!==this.private_box&&this.private_box.setInterline(a)};BytescoutPDF.prototype.textSetBoxPadding=function(a,b,c,d){this.private_padding=void 0===b?{left:a,top:a,right:a,bottom:a}:{left:a,top:b,right:c,bottom:d}};
BytescoutPDF.prototype.textSetBox=function(a,b,c,d){var e=this.private_padding;this.private_box=new PDFBox(this.private_currentPage,a+e.left,b+e.top,c-e.left-e.right,d-e.top-e.bottom,this.private_textAlign,this.private_interline)};BytescoutPDF.prototype.addLink=function(a,b,c,d,e){a=new PDFLink({x:a,y:this.private_currentPage.h-b,width:a+c,height:this.private_currentPage.h-b-d},e);this.private_add(a);this.private_currentPage.addLink(a)};
BytescoutPDF.prototype.textSetLinkStyle=function(a,b,c,d){this.private_textState.setLinkStyle(a,new PDFColor(b,c,d))};BytescoutPDF.prototype.addAnchor=function(a,b,c){this.private_anchors.push({name:a.toLowerCase(),page:b,offset:c})};BytescoutPDF.prototype.addBookmark=function(a,b,c){b=null==a?new PDFBookmark(this.private_outlines,b,c):new PDFBookmark(a,b,c);this.private_add(b);null==a?this.private_outlines.addBookmark(b):a.addBookmark(b);return b};
BytescoutPDF.prototype.private_setFont=function(a){var b=a.getFontName();if(null!=b){var c=null,d;for(d=0;d<this.private_fonts.length;d++)this.private_fonts[d].fontName==b&&(c=this.private_fonts[d]);null==c&&(c=new PDFFont(b),this.private_add(c),this.private_fonts.push(c));a.setFont(c)}else throw"it should never arrive here";};
BytescoutPDF.prototype.textAdd=function(a,b,c,d){if(isNaN(a))throw new BytescoutPDFFatalError("x is NaN");if(isNaN(b))throw new BytescoutPDFFatalError("y is NaN");isNaN(d)&&(d=0);var e=this.private_textState.clone();c=new PDFHtmlParser(this,c,e);for(a={x:a,y:b,topY:b-e.fontSize};!c.last();)b=c.nextText(),""!=b&&(void 0===e.font&&this.private_setFont(e),a=this.private_currentPage.textAdd(a.x,a.y,b,e,d)),c.nextTag(a)};
BytescoutPDF.prototype.textAddToBox=function(a,b,c){if(void 0==this.private_box)throw"ERROR: textAddToBox can not write in an empty box.";void 0===b&&(b=!0);void 0===c&&(c=!0);var d;"string"===typeof a?d=new PDFHtmlParser(this,a,this.private_textState):(d=a.parser,f=a);for(var e=0;!d.last()&&0==e&&this.private_box.canWrite(this.private_textState.fontSize);)e=d.nextText(f),void 0===this.private_textState.font&&this.private_setFont(this.private_textState),a=this.private_currentPage.textAddToBox(this.private_box,
e,0,c,this.private_textState),e=e.length-a.pos,0==e&&d.nextTag(a);d.last()&&0==e&&this.private_box.flush(b,c);var f={end:d.last()&&0==e,bottomY:this.private_box.bottomY};f.end||(f.pos=d.getCurrentChar()-e,d.ant=f.pos,f.parser=d);return f};BytescoutPDF.prototype.textFitsBox=function(a){if(void 0!==this.private_box){var b=this.private_box.offsetX,c=this.private_box.offsetY;a=this.textAddToBox(a,!0,!1);this.private_box.offsetX=b;this.private_box.offsetY=c;return a.end}return!0};
BytescoutPDF.prototype.imageSetDefaultBackgroundColor=function(a,b,c){this.private_imageBackgroundColor=new PDFColor(a,b,c)};BytescoutPDF.prototype.imageLoadFromUrl=function(a){var b=null,c;for(c=0;c<this.private_images.length&&null==b;c++)this.private_images[c].fileName==a&&(b=this.private_images[c]);null==b&&(b=new PDFImageFromUrl(a,this),this.private_add(b),this.private_images.push(b));this.currentImage=b};
BytescoutPDF.prototype.imageLoadFromCanvas=function(a){a=new PDFImageFromCanvas(a,this);this.private_add(a);this.private_images.push(a);this.currentImage=a};BytescoutPDF.prototype.imagePlace=function(a,b,c){this.private_currentPage.imagePlace(a,b,this.currentImage,this.private_alpha,c,-1,-1)};BytescoutPDF.prototype.imagePlaceSetSize=function(a,b,c,d,e){this.private_currentPage.imagePlace(a,b,this.currentImage,this.private_alpha,c,d,e)};
BytescoutPDF.prototype.graphicsDrawLine=function(a,b,c,d){this.private_currentPage.drawLine(a,b,c,d,this.private_lineColor,this.private_alpha,this.private_lineWidth,this.private_lineEndType)};BytescoutPDF.prototype.graphicsDrawRectangle=function(a,b,c,d){this.private_currentPage.drawRectangle(a,b,c,d,this.private_lineColor,this.private_alpha,this.private_lineWidth)};
BytescoutPDF.prototype.graphicsDrawRectangleFill=function(a,b,c,d){this.private_currentPage.drawRectangleFill(a,b,c,d,this.private_lineColor,this.private_alpha)};BytescoutPDF.prototype.graphicsSetColor=function(a,b,c){this.private_lineColor=new PDFColor(a,b,c)};BytescoutPDF.prototype.graphicsSetAlpha=function(a){this.private_alpha=Math.floor(100*a/255)/100;this.private_textState.setAlpha(a)};BytescoutPDF.prototype.graphicsSetLineWidth=function(a){this.private_lineWidth=a};BytescoutPDF.BUTT_CAP=0;
BytescoutPDF.ROUND_CAP=1;BytescoutPDF.PROJECTING_SQUARE_CAP=2;BytescoutPDF.prototype.graphicsSetLineEndType=function(a){this.private_lineEndType=a};
BytescoutPDF.prototype.private_onload=function(){if(void 0!=this.loadedFunction){for(var a=!0,b=0;b<this.private_images.length;b++)if(0==this.private_images[b].loaded)if(1==this.private_images[b].badImage){if(void 0!=console&&(console.log("image object #"+b+" : there was error loading the image"),this.stopOnInvalidImages))throw new BytescoutPDFFatalError("CRITICAL ERROR: Image object #"+b+" can nto be loaded or there was error in the image");}else a=!1;a&&this.loadedFunction()}};
BytescoutPDF.prototype.onload=function(a){this.loadedFunction=a;this.private_onload()};
BytescoutPDF.prototype.getText=function(a){var b="%PDF-1.4"+BytescoutPDF.CRLF,c,d;for(c=0;c<this.private_objects.length;c++)d=this.private_objects[c],d.offset=b.length,d=d.getText(this,a),b+=d;a=b.length;b+="xref"+BytescoutPDF.CRLF;b+="0 "+(this.private_objects.length+1)+BytescoutPDF.CRLF;b+="0000000000 65535 f"+BytescoutPDF.CRLF;for(c=0;c<this.private_objects.length;c++)d=this.private_objects[c],d="0000000000"+d.offset,b+=d.substring(d.length-10)+" 00000 n"+BytescoutPDF.CRLF;b+="trailer"+BytescoutPDF.CRLF;
b+="<< /Size "+(this.private_objects.length+1)+BytescoutPDF.CRLF;b+="/Root "+this.private_catalog.id+" 0 R"+BytescoutPDF.CRLF;b+="/Info "+this.private_info.id+" 0 R"+BytescoutPDF.CRLF;b+=">>"+BytescoutPDF.CRLF;b+="startxref"+BytescoutPDF.CRLF;b+=a+BytescoutPDF.CRLF;b+="%%EOF";try{b=decodeURIComponent(escape(b))}catch(e){}return b};BytescoutPDF.prototype.getBase64Text=function(){return this.base64Encode(this.getText(this))};
BytescoutPDF.prototype.base64Encode=function(a){for(var b="",c,d,e,f,g,h,k=0;k<a.length;)c=a.charCodeAt(k++),d=a.charCodeAt(k++),e=a.charCodeAt(k++),f=c>>2,c=(c&3)<<4|d>>4,g=(d&15)<<2|e>>6,h=e&63,isNaN(d)?g=h=64:isNaN(e)&&(h=64),b=b+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(f)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h);
return b};function PDFObject(a,b){this.type=a;this.offset=void 0;this.props=[];this.stream=void 0;void 0!==a&&this.props.push(new PDFProperty("/Type",a));void 0!==b&&(this.value=b)}PDFObject.prototype.addProperty=function(a){this.props.push(a)};PDFObject.prototype.getRef=function(){return""+this.id+" 0 R"};
PDFObject.prototype.getText=function(a){var b;b=""+(this.id+" 0 obj"+BytescoutPDF.CRLF);b+="<<";for(var c=0;c<this.props.length;c++)b+=this.props[c].getText(a)+BytescoutPDF.CRLF;b+=">>"+BytescoutPDF.CRLF;void 0!=this.stream&&(b+="stream"+BytescoutPDF.CRLF+this.stream+BytescoutPDF.CRLF+"endstream"+BytescoutPDF.CRLF);void 0!=this.value&&(b+=this.value+BytescoutPDF.CRLF);return b+="endobj"+BytescoutPDF.CRLF};
function PDFProperty(a,b){this.name=a;this.props=[];b instanceof PDFObject?this.reference=b:void 0!==b&&(this.value=b)}PDFProperty.prototype.add=function(a){this.props.push(a)};PDFProperty.prototype.getText=function(a){var b;b=""+(this.name+" ");if(void 0!==this.value)b+=this.value;else if(void 0!==this.reference)b+=this.reference.getRef();else if(0<this.props.length){b+="<<";for(var c=0;c<this.props.length;c++)b+=this.props[c].getText(a);b+=">>"}return b};PDFCatalog.prototype=new PDFObject;
PDFCatalog.prototype.constructor=PDFCatalog;function PDFCatalog(){PDFObject.call(this,"/Catalog");this.addProperty(new PDFProperty("/Markings"," <</Marked true >>"))}PDFCatalog.prototype.setOutline=function(a){this.outlines=a;this.addProperty(new PDFProperty("/Outlines",a))};PDFCatalog.prototype.setPages=function(a){this.addProperty(new PDFProperty("/Pages",a))};
PDFCatalog.prototype.getText=function(a){0<this.outlines.getCount()&&this.addProperty(new PDFProperty("/PageMode","/UseOutlines"));return PDFObject.prototype.getText.call(this,a)};PDFInfo.prototype=new PDFObject;PDFInfo.prototype.constructor=PDFInfo;function PDFInfo(){PDFObject.call(this)}PDFInfo.prototype.set=function(a,b,c,d,e){this.title=a;this.subject=b;this.keywords=c;this.author=d;this.creator=e};PDFInfo.prototype.addZeros=function(a){a="00"+a;return a=a.substr(a.length-2)};
PDFInfo.prototype.getText=function(a){this.addProperty(new PDFProperty("/Title","("+this.title+")"));this.addProperty(new PDFProperty("/Subject","("+this.subject+")"));this.addProperty(new PDFProperty("/Keywords","("+this.keywords+")"));this.addProperty(new PDFProperty("/Author","("+this.author+")"));this.addProperty(new PDFProperty("/Creator","("+this.creator+")"));var b=new Date;this.addProperty(new PDFProperty("/CreationDate","(D:"+b.getFullYear()+this.addZeros(b.getMonth()+1)+this.addZeros(b.getDate())+
this.addZeros(b.getHours())+this.addZeros(b.getMinutes())+this.addZeros(b.getSeconds())+"+00'00')"));this.addProperty(new PDFProperty("/ModDate","(D:"+b.getFullYear()+this.addZeros(b.getMonth()+1)+this.addZeros(b.getDate())+this.addZeros(b.getHours())+this.addZeros(b.getMinutes())+this.addZeros(b.getSeconds())+"+00'00')"));this.addProperty(new PDFProperty("/Producer","(BytescoutPDF.js 1.16.151)"));return PDFObject.prototype.getText.call(this,a)};PDFOutlines.prototype=new PDFObject;
PDFOutlines.prototype.constructor=PDFOutlines;function PDFOutlines(){this.outlines=[];PDFObject.call(this,"/Outlines")}PDFOutlines.prototype.addBookmark=function(a){this.outlines.push(a)};PDFOutlines.prototype.getCount=function(){return this.outlines.length};
PDFOutlines.prototype.getText=function(a){var b=this.outlines.length;0<b&&(this.addProperty(new PDFProperty("/First",this.outlines[0].getRef())),this.addProperty(new PDFProperty("/Last",this.outlines[b-1].getRef())));this.addProperty(new PDFProperty("/Count",b));PDFBookmark.setNeighbours(this.outlines);return PDFObject.prototype.getText.call(this,a)};PDFBookmark.prototype=new PDFObject;PDFBookmark.prototype.constructor=PDFBookmark;
function PDFBookmark(a,b,c){PDFObject.call(this);this.childs=[];this.addProperty(new PDFProperty("/Title","("+b+")"));this.addProperty(new PDFProperty("/Parent",a.getRef()));this.addProperty(new PDFAction(c))}PDFBookmark.prototype.addBookmark=function(a){this.childs.push(a)};PDFBookmark.prototype.setNeighbours=function(a,b){null!=a&&this.addProperty(new PDFProperty("/Prev",a.getRef()));null!=b&&this.addProperty(new PDFProperty("/Next",b.getRef()));PDFBookmark.setNeighbours(this.childs)};
PDFBookmark.setNeighbours=function(a){var b=null;next=null;for(var c=0;c<a.length;c++)c+1<a.length&&(next=a[c+1]),a[c].setNeighbours(b,next),b=a[c]};PDFBookmark.prototype.getText=function(a){var b=this.childs.length;0<b&&(this.addProperty(new PDFProperty("/First",this.childs[0].getRef())),this.addProperty(new PDFProperty("/Last",this.childs[b-1].getRef())));this.addProperty(new PDFProperty("/Count",b));return PDFObject.prototype.getText.call(this,a)};PDFPages.prototype=new PDFObject;
PDFPages.prototype.constructor=PDFPages;function PDFPages(){PDFObject.call(this,"/Pages");this.pages=[]}PDFPages.prototype.addPage=function(a){this.pages.push(a);a.setPageNumber(this.pages.length);return a};PDFPages.prototype.getCount=function(){return this.pages.length};PDFPages.prototype.getPage=function(a){return this.pages[a]};PDFPages.prototype.getIndex=function(a){return this.pages.indexOf(a)};
PDFPages.prototype.getText=function(a){for(var b="",c=0;c<this.pages.length;c++)b+=this.pages[c].getRef()+" ";this.addProperty(new PDFProperty("/Kids","["+b+"]"));this.addProperty(new PDFProperty("/Count",this.pages.length));return PDFObject.prototype.getText.call(this,a)};Array.prototype.indexOf||(Array.prototype.indexOf=function(a){for(var b=0;b<this.length;b++)if(this[b]===a)return b;return-1});PDFPage.prototype=new PDFObject;PDFPage.prototype.constructor=PDFPage;
function PDFPage(a,b,c,d,e){PDFObject.call(this,"/Page");this.pdf=a;this.pageNumber=void 0;this.parent=e;this.fonts=[];this.images=[];this.imageInstances=[];this.alphas=[];this.links=[];this.currentAlpha=1;this.w=72*b;this.h=72*c;d||(a=this.w,this.w=this.h,this.h=a)}PDFPage.prototype.setStream=function(a){this.pdfStream=a};PDFPage.prototype.addLink=function(a){this.links.push(a)};PDFPage.prototype.setPageNumber=function(a){this.pageNumber=a};
function replaceAll(a,b,c,d){return a.replace(new RegExp(b.replace(/([\/\,\!\\\^\$\{\}\[\]\(\)\.\*\+\?\|\<\>\-\&])/g,"\\$&"),d?"gi":"g"),"string"==typeof c?c.replace(/\$/g,"$$$$"):c)}
function NormalizeTextStringToPDFString(a){a=replaceAll(a,"\\","\\\\",!1);a=replaceAll(a,"(","\\(",!1);a=replaceAll(a,")","\\)",!1);a=replaceAll(a,"&lt;","<",!0);a=replaceAll(a,"&gt;",">",!0);a=replaceAll(a,"&quot;",'"',!0);a=replaceAll(a,"&amp;","&",!0);a=replaceAll(a,"&apos;","'",!0);a=replaceAll(a,"\r\n","\n",!0);a=replaceAll(a,"\r","",!0);for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c)&255;(31<d||13==d||10==d)&&(128>d||159<d)&&(b+=String.fromCharCode(d))}return b}
PDFPage.prototype.textAdd=function(a,b,c,d,e,f){if(isNaN(a))throw new BytescoutPDFFatalError("x is NaN");if(isNaN(b))throw new BytescoutPDFFatalError("y is NaN");isNaN(e)&&(e=0);-1==this.fonts.indexOf(d.font)&&this.fonts.push(d.font);var g=parseInt(this.h-b);if(isNaN(g))throw new BytescoutPDFFatalError("page height is NaN");text=NormalizeTextStringToPDFString(c);var h,k;void 0!=e&&(e=e*Math.PI/180,h=Math.round(100*Math.cos(e))/100,k=Math.round(100*Math.sin(e))/100);var l=void 0===d.link||void 0===
d.linkColor?d.color:d.linkColor,m=void 0===d.link||void 0===d.linkUnderline?d.underline:d.linkUnderline,n=d.strike;this.setAlpha(d.alpha);this.pdfStream.addText("q BT "+l.getFloatRGB()+" rg "+d.font.getIdFont()+" "+d.fontSize+" Tf "+(void 0!==f?""+f+" Tw ":"")+"1 0 0 1 "+a+" "+g+" cm "+(void 0!=e?""+h+" "+k+" "+-k+" "+h+" 0 0 cm ":"")+"("+c+")Tj ET Q ");f=d.font.getUnscaledTextWidth(c)*d.fontSize/1E3;c={x:a+f*(void 0===e?1:Math.cos(e)),y:b-f*(void 0===e?0:Math.sin(e))};c.topY=c.y-d.fontSize;m&&this.drawLine(a,
b+1,c.x,c.y+1,l,d.alpha,1,0);n&&this.drawLine(a,b-Math.round(d.fontSize/3),c.x,c.y-Math.round(d.fontSize/3),l,d.alpha,1,0);d.link&&(void 0===e?this.pdf.addLink(a,b-d.fontSize,f,d.fontSize,d.link):(e=this.boundingBox(f,d.fontSize,e),this.pdf.addLink(a+e.minX,b-e.maxY,e.maxX-e.minX,e.maxY-e.minY,d.link)));return c};
PDFPage.prototype.boundingBox=function(a,b,c){a=[{x:0,y:0},{x:0,y:b},{x:a,y:0},{x:a,y:b}];b=Math.cos(c);c=Math.sin(c);for(var d={minX:Math.min(),maxX:Math.max(),minY:Math.min(),maxY:Math.max()},e=0;e<a.length;e++){var f=a[e],f={x:f.x*b-f.y*c,y:f.x*c+f.y*b};f.x<d.minX&&(d.minX=f.x);f.x>d.maxX&&(d.maxX=f.x);f.y<d.minY&&(d.minY=f.y);f.y>d.maxY&&(d.maxY=f.y)}return d};
PDFPage.prototype.nchars=function(a,b,c,d,e,f){for(var g=d,h=!1,k=a;g<c.length&&!h;)if(-1!="\r\n".indexOf(c.charAt(g)))h=!0;else{var l=e.getTextWidth(c.charAt(g),f);k+l<=b?(g++,k+=l):h=!0}if(g>d&&g<c.length&&(-1==" \r\n".indexOf(c.charAt(g-1))||-1==".,-;".indexOf(c.charAt(g-1))))if(b=-1,-1==b&&(b=c.lastIndexOf("\r",g)),-1==b&&(b=c.lastIndexOf("\n",g)),-1==b&&(b=c.lastIndexOf(" ",g)),-1==b&&0<a)k=a,g=d;else if(b>=d){for(d=b;d<g;d++)k-=e.getTextWidth(c.charAt(d),f);g=b+1}return{endText:g,endLine:h,
width:k-a}};PDFPage.prototype.textAddToBox=function(a,b,c,d,e){if(""!=b)for(var f=this.nchars(a.offsetX,a.width,b,c,e.font,e.fontSize);c<b.length&&a.canWrite(e.fontSize);){c=b.substring(c,f.endText);""==c&&(f.endText+=1);a.bufferedTextAdd(c,e,f.width);f.endLine&&a.flush(!1,d);c=f.endText;if(0==a.offsetX)for(;c<b.length&&-1<" ".indexOf(b.charAt(c));)c++;f=this.nchars(a.offsetX,a.width,b,c,e.font,e.fontSize)}a={pos:c,topY:a.y+a.offsetY};a.pos<b.length&&(a.text=b);return a};
PDFPage.prototype.setAlpha=function(a){if(a!=this.currentAlpha){for(var b=!1,c=0;!b&&c<this.alphas.length;)this.alphas[c]==a?b=!0:c++;b||this.alphas.push(a);this.pdfStream.addText("/EGS"+c+" gs ");this.currentAlpha=a}};
PDFPage.prototype.drawLine=function(a,b,c,d,e,f,g,h){if(isNaN(a))throw new BytescoutPDFFatalError("x0 is NaN");if(isNaN(b))throw new BytescoutPDFFatalError("y0 is NaN");if(isNaN(c))throw new BytescoutPDFFatalError("x1 is NaN");if(isNaN(d))throw new BytescoutPDFFatalError("y1 is NaN");if(isNaN(g))throw new BytescoutPDFFatalError("width is NaN");b=parseInt(this.h-b);d=parseInt(this.h-d);this.setAlpha(f);this.pdfStream.addText(""+g+" w "+h+" J "+e.getFloatRGB()+" RG "+a+" "+b+" m "+c+" "+d+" l S ")};
PDFPage.prototype.drawRectangle=function(a,b,c,d,e,f,g){if(isNaN(a))throw new BytescoutPDFFatalError("x0 is NaN");if(isNaN(b))throw new BytescoutPDFFatalError("y0 is NaN");if(isNaN(c))throw new BytescoutPDFFatalError("width is NaN");if(isNaN(d))throw new BytescoutPDFFatalError("height is NaN");isNaN(g)&&(g=1);c=a+c;b=parseInt(this.h-b);y1=b-d;this.setAlpha(f);this.pdfStream.addText(""+g+" w "+e.getFloatRGB()+" RG "+a+" "+b+" m "+c+" "+b+" l "+c+" "+y1+" l "+a+" "+y1+" l "+a+" "+b+" l S ")};
PDFPage.prototype.drawRectangleFill=function(a,b,c,d,e,f){if(isNaN(a))throw new BytescoutPDFFatalError("x is NaN");if(isNaN(b))throw new BytescoutPDFFatalError("y is NaN");if(isNaN(c))throw new BytescoutPDFFatalError("width is NaN");if(isNaN(d))throw new BytescoutPDFFatalError("height is NaN");b=parseInt(this.h-b-d);this.setAlpha(f);this.pdfStream.addText(""+e.getFloatRGB()+" RG "+e.getFloatRGB()+" rg "+a+" "+b+" "+c+" "+d+" re B ")};
PDFPage.prototype.imagePlace=function(a,b,c,d,e,f,g){if(isNaN(a))throw new BytescoutPDFFatalError("x is NaN");if(isNaN(b))throw new BytescoutPDFFatalError("y is NaN");if(isNaN(f))throw new BytescoutPDFFatalError("width is NaN");if(isNaN(g))throw new BytescoutPDFFatalError("height is NaN");this.setAlpha(d);this.pdfStream.addText("\\Im"+this.imageInstances.length+" ");-1==this.images.indexOf(c)&&this.images.push(c);this.imageInstances.push(new PDFImageInstance(a,this.h-b-2,c,d,e,f,g))};
PDFPage.prototype.getText=function(a){a.showBytescoutLink&&(a.fontSetColor(212,212,212),a.textSetBox(20,this.h-20,this.w-40,20),a.textSetAlign(BytescoutPDF.RIGHT),a.textSetLinkStyle(!1,"#D4D4D4"),a.textAddToBox('<a href="http://bytescout.com/products/developer/pdfgeneratorsdkjs/index.html">Generated by Bytescout PDF Generator SDK for Javascript</a>'),a.fontSetColor(0,0,0));a.private_pageSetCurrent(this);void 0!==a.private_onFooter&&a.private_onFooter(a);for(var b=0;b<this.imageInstances.length;b++){var c=
this.imageInstances[b];if(1==c.badImage&&void 0!=console&&(console.log("image "+b+" is bad image so skiping from final pdf output"),a.stopOnInvalidImages))throw new BytescoutPDFFatalError("CRITICAL ERROR: Image object #"+b+" is invalid so stopping the script");var d,e;void 0!=c.angle&&(e=c.angle*Math.PI/180,d=Math.round(100*Math.cos(e))/100,e=Math.round(100*Math.sin(e))/100);var f=-1!=c.width?c.width:c.image.width/2,g=-1!=c.height?c.height:c.image.height/2;if(isNaN(f)){void 0!=console&&console.log("image width is NaN! Forcing into zero");
if(a.stopOnInvalidImages)throw new BytescoutPDFFatalError("CRITICAL ERROR: Image object #"+b+" image width is NaN");f=0}if(isNaN(g)){void 0!=console&&console.log("image height is NaN! Forcing into zero");if(a.stopOnInvalidImages)throw new BytescoutPDFFatalError("CRITICAL ERROR: Image object #"+b+" image height is NaN");g=0}this.pdfStream.replaceText("\\Im"+b,"q 1 0 0 1 "+c.x+" "+(c.y-g)+" cm "+(void 0!=c.angle?""+d+" "+e+" "+-e+" "+d+" 0 0 cm ":"")+f+" 0 0 "+g+" 0 0 cm /Im"+c.image.id+" Do Q ")}this.addProperty(new PDFProperty("/Parent",
this.parent));this.addProperty(new PDFProperty("/MediaBox","[0 0 "+this.w+" "+this.h+"]"));this.addProperty(new PDFProperty("/Group","<</S/Transparency /CS/DeviceRGB /I true>>"));if(0<this.links.length){b="[";for(c=0;c<this.links.length;c++)b+=this.links[c].getRef()+" ";this.addProperty(new PDFProperty("/Annots",b+"]"))}this.addProperty(new PDFProperty("/Contents",this.pdfStream));b=new PDFProperty("/Resources");if(0<this.fonts.length){d=new PDFProperty("/Font");for(c=0;c<this.fonts.length;c++)e=
this.fonts[c],d.add(new PDFProperty(e.getIdFont(),e));b.add(d)}if(0<this.alphas.length){d=new PDFProperty("/ExtGState");for(c=0;c<this.alphas.length;c++)e=new PDFProperty("/EGS"+c),e.add(new PDFProperty("/CA",this.alphas[c])),e.add(new PDFProperty("/ca",this.alphas[c])),d.add(e);b.add(d)}if(0<this.images.length){b.add(new PDFProperty("/ProcSet","[/PDF /ImageB]"));c=new PDFProperty("/XObject");for(d=0;d<this.images.length;d++)e=this.images[d],c.add(new PDFProperty("/Im"+e.id,e));b.add(c)}else b.add(new PDFProperty("/ProcSet",
"[/PDF /Text]"));this.addProperty(b);return PDFObject.prototype.getText.call(this,a)};function PDFBufferedLine(a){this.box=a;this.fragments=[];this.maxFontSize=0}PDFBufferedLine.prototype.bufferedTextAdd=function(a,b,c,d){this.fragments.push({text:a,state:b.clone(),offsetX:c,width:d});b.fontSize>this.maxFontSize&&(this.maxFontSize=b.fontSize)};
PDFBufferedLine.prototype.countWords=function(){for(var a=0,b=0;b<this.fragments.length;b++){for(var c=!1,d=0,e=this.fragments[b].text,f=0;f<e.length;f++)" "==e.charAt(f)?c&&(c=!1):c||(c=!0,d++);this.fragments[b].nWords=d;a+=d}0==a&&(a=1);return a};PDFBufferedLine.prototype.canFlush=function(){return 0<this.fragments.length};
PDFBufferedLine.prototype.flush=function(a,b){if(b){var c=0,d=0;this.box.align!=BytescoutPDF.JUSTIFIED||a?this.box.align==BytescoutPDF.RIGHT?d+=this.box.width-this.box.offsetX:this.box.align==BytescoutPDF.CENTER&&(d+=(this.box.width-this.box.offsetX)/2):(c=this.countWords(),c=(this.box.width-this.box.offsetX)/(1<c?c-1:1));for(var e=0;e<this.fragments.length;e++){var f=this.fragments[e];this.box.textAdd(d+f.offsetX,this.box.offsetY+this.maxFontSize,f.text,f.state,c);this.box.align!=BytescoutPDF.JUSTIFIED||
a||(d+=f.nWords*c)}}this.maxFontSize=0;this.fragments=[];this.forceNewLine=!1};PDFFont.prototype=new PDFObject;PDFFont.prototype.constructor=PDFFont;
function PDFFont(a){PDFObject.call(this,"/Font");var b=null;switch(a){case "Times-Roman":b=PDFFont.timesWidths;break;case "Times-Bold":b=PDFFont.timesBoldWidths;break;case "Times-Italic":b=PDFFont.timesItalicWidths;break;case "Times-BoldItalic":b=PDFFont.timesBoldItalicWidths;break;case "Helvetica":b=PDFFont.helveticaWidths;break;case "Helvetica-Bold":b=PDFFont.helveticaBoldWidths;break;case "Helvetica-Oblique":b=PDFFont.helveticaItalicWidths;break;case "Helvetica-BoldOblique":b=PDFFont.helveticaBoldItalicWidths;
break;case "Symbol":b=PDFFont.symbolWidths;break;case "ZapfDingbats":b=PDFFont.zapfdingbatsWidths;break;case "Courier":b=PDFFont.courierWidths;break;case "Courier-Bold":b=PDFFont.courierWidths;break;case "Courier-Oblique":b=PDFFont.courierWidths;break;case "Courier-BoldOblique":b=PDFFont.courierWidths;break;default:throw"invalid pdf font name";}this.fontName=a;this.charWidths=b}
PDFFont.normalizeCase=function(a){switch(a.toLowerCase()){case "symbol":return"Symbol";case "zapfdingbats":case "zapf-dingbats":return"ZapfDingbats";case "times-roman":return"Times-Roman";case "helvetica":return"Helvetica";case "courier":return"Courier"}throw"no such a fontname: "+a+". Allows font names: Times-Roman, Helvetica, Courier, Symbol, ZapfDingbats. You may use fontSetStyle() to set bold, italic, underline styles for Times-Roman, Helvetica, Courier";};
PDFFont.getPDFName=function(a,b,c){var d=null;a=this.normalizeCase(a);if("Symbol"==a||"ZapfDingbats"==a)d=a;else if(!b&&!c)switch(a){case "Times-Roman":case "Helvetica":case "Courier":d=a}else if(b&&!c)switch(a){case "Times-Roman":d="Times-Bold";break;case "Helvetica":d="Helvetica-Bold";break;case "Courier":d="Courier-Bold"}else if(!b&&c)switch(a){case "Times-Roman":d="Times-Italic";break;case "Helvetica":case "Courier":d=a+"-Oblique"}else if(b&&c)switch(a){case "Times-Roman":d="Times-BoldItalic";
break;case "Helvetica":case "Courier":d=a+"-BoldOblique"}return d};
PDFFont.timesWidths=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,250,333,408,500,500,833,778,180,333,333,500,564,250,333,250,278,500,500,500,500,500,500,500,500,500,500,278,278,564,564,564,444,921,722,667,667,722,611,556,722,722,333,389,722,611,889,722,722,556,722,667,556,611,722,722,944,722,722,611,333,278,333,469,500,333,444,500,444,500,444,333,500,500,278,278,500,278,778,500,500,500,500,333,389,278,500,500,722,500,500,444,480,200,480,541,0,500,0,333,500,444,1E3,500,500,333,
1E3,556,333,889,0,611,0,0,333,333,444,444,350,500,1E3,333,980,389,333,722,0,444,722,250,333,500,500,500,500,200,500,333,760,276,500,564,0,760,333,400,564,0,0,333,500,453,250,333,0,310,500,750,750,750,444,722,722,722,722,722,722,889,667,611,611,611,611,333,333,333,333,722,722,722,722,722,722,722,564,722,722,722,722,722,722,556,500,444,444,444,444,444,444,667,444,444,444,444,444,278,278,278,278,500,500,500,500,500,500,500,564,500,500,500,500,500,500,500,500];
PDFFont.timesBoldWidths=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,250,333,555,500,500,1E3,833,278,333,333,500,570,250,333,250,278,500,500,500,500,500,500,500,500,500,500,333,333,570,570,570,500,930,722,667,722,722,667,611,778,778,389,500,778,667,944,722,778,611,778,722,556,667,722,722,1E3,722,722,667,333,278,333,581,500,333,500,556,444,556,444,333,500,556,278,333,556,278,833,556,500,556,556,444,389,333,556,500,722,500,500,444,394,220,394,520,0,500,0,333,500,500,1E3,500,500,
333,1E3,556,333,1E3,0,667,0,0,333,333,500,500,350,500,1E3,333,1E3,389,333,722,0,444,722,250,333,500,500,500,500,220,500,333,747,300,500,570,0,747,333,400,570,0,0,333,556,540,250,333,0,330,500,750,750,750,500,722,722,722,722,722,722,1E3,722,667,667,667,667,389,389,389,389,722,722,778,778,778,778,778,570,778,722,722,722,722,722,611,556,500,500,500,500,500,500,722,444,444,444,444,444,278,278,278,278,500,556,500,500,500,500,500,570,500,556,556,556,556,500,556,500];
PDFFont.timesItalicWidths=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,250,333,420,500,500,833,778,214,333,333,500,675,250,333,250,278,500,500,500,500,500,500,500,500,500,500,333,333,675,675,675,500,920,611,611,667,722,611,611,722,722,333,444,667,556,833,667,722,611,722,611,500,556,722,611,833,611,556,556,389,278,389,422,500,333,500,500,444,500,444,278,500,500,278,278,444,278,722,500,500,500,500,389,389,278,500,444,667,444,444,389,400,275,400,541,0,500,0,333,500,556,889,500,500,
333,1E3,500,333,944,0,556,0,0,333,333,556,556,350,500,889,333,980,389,333,667,0,389,556,250,389,500,500,500,500,275,500,333,760,276,500,675,0,760,333,400,675,0,0,333,500,523,250,333,0,310,500,750,750,750,500,611,611,611,611,611,611,889,667,611,611,611,611,333,333,333,333,722,667,722,722,722,722,722,675,722,722,722,722,722,556,611,500,500,500,500,500,500,500,667,444,444,444,444,444,278,278,278,278,500,500,500,500,500,500,500,675,500,500,500,500,500,444,500,444];
PDFFont.timesBoldItalicWidths=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,250,389,555,500,500,833,778,278,333,333,500,570,250,333,250,278,500,500,500,500,500,500,500,500,500,500,333,333,570,570,570,500,832,667,667,667,722,667,667,722,778,389,500,667,611,889,722,722,611,722,667,556,611,722,667,889,667,611,611,333,278,333,570,500,333,500,500,444,500,444,333,500,556,278,278,500,278,778,556,500,500,500,389,389,278,556,444,667,500,444,389,348,220,348,570,0,500,0,333,500,500,1E3,500,
500,333,1E3,556,333,944,0,611,0,0,333,333,500,500,350,500,1E3,333,1E3,389,333,722,0,389,611,250,389,500,500,500,500,220,500,333,747,266,500,606,0,747,333,400,570,0,0,333,576,500,250,333,0,300,500,750,750,750,500,667,667,667,667,667,667,944,667,667,667,667,667,389,389,389,389,722,722,722,722,722,722,722,570,722,722,722,722,722,611,611,500,500,500,500,500,500,500,722,444,444,444,444,444,278,278,278,278,500,556,500,500,500,500,500,570,500,556,556,556,556,444,500,444];
PDFFont.helveticaWidths=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,278,278,355,556,556,889,667,191,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,278,278,584,584,584,556,1015,667,667,722,722,667,611,778,722,278,500,667,556,833,722,778,667,778,722,667,611,722,667,944,667,667,611,278,278,278,469,556,333,556,556,500,556,556,278,556,556,222,222,500,222,833,556,556,556,556,333,500,278,556,500,722,500,500,500,334,260,334,584,0,556,0,222,556,333,1E3,556,556,
333,1E3,667,333,1E3,0,611,0,0,222,222,333,333,350,556,1E3,333,1E3,500,333,944,0,500,667,278,333,556,556,556,556,260,556,333,737,370,556,584,0,737,333,400,584,0,0,333,556,537,278,333,0,365,556,834,834,834,611,667,667,667,667,667,667,1E3,722,667,667,667,667,278,278,278,278,722,722,778,778,778,778,778,584,778,722,722,722,722,667,667,611,556,556,556,556,556,556,889,500,556,556,556,556,278,278,278,278,556,556,556,556,556,556,556,584,611,556,556,556,556,500,556,500];
PDFFont.helveticaBoldWidths=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,278,333,474,556,556,889,722,238,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,333,333,584,584,584,611,975,722,722,722,722,667,611,778,722,278,556,722,611,833,722,778,667,778,722,667,611,722,667,944,667,667,611,333,278,333,584,556,333,556,611,556,611,556,333,611,611,278,278,556,278,889,611,611,611,611,389,556,333,611,556,778,556,556,500,389,280,389,584,0,556,0,278,556,500,1E3,556,
556,333,1E3,667,333,1E3,0,611,0,0,278,278,500,500,350,556,1E3,333,1E3,556,333,944,0,500,667,278,333,556,556,556,556,280,556,333,737,370,556,584,0,737,333,400,584,0,0,333,611,556,278,333,0,365,556,834,834,834,611,722,722,722,722,722,722,1E3,722,667,667,667,667,278,278,278,278,722,722,778,778,778,778,778,584,778,722,722,722,722,667,667,611,556,556,556,556,556,556,889,556,556,556,556,556,278,278,278,278,611,611,611,611,611,611,611,584,611,611,611,611,611,556,611,556];
PDFFont.helveticaItalicWidths=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,278,278,355,556,556,889,667,191,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,278,278,584,584,584,556,1015,667,667,722,722,667,611,778,722,278,500,667,556,833,722,778,667,778,722,667,611,722,667,944,667,667,611,278,278,278,469,556,333,556,556,500,556,556,278,556,556,222,222,500,222,833,556,556,556,556,333,500,278,556,500,722,500,500,500,334,260,334,584,0,556,0,222,556,333,1E3,556,
556,333,1E3,667,333,1E3,0,611,0,0,222,222,333,333,350,556,1E3,333,1E3,500,333,944,0,500,667,278,333,556,556,556,556,260,556,333,737,370,556,584,0,737,333,400,584,0,0,333,556,537,278,333,0,365,556,834,834,834,611,667,667,667,667,667,667,1E3,722,667,667,667,667,278,278,278,278,722,722,778,778,778,778,778,584,778,722,722,722,722,667,667,611,556,556,556,556,556,556,889,500,556,556,556,556,278,278,278,278,556,556,556,556,556,556,556,584,611,556,556,556,556,500,556,500];
PDFFont.helveticaBoldItalicWidths=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,278,333,474,556,556,889,722,238,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,333,333,584,584,584,611,975,722,722,722,722,667,611,778,722,278,556,722,611,833,722,778,667,778,722,667,611,722,667,944,667,667,611,333,278,333,584,556,333,556,611,556,611,556,333,611,611,278,278,556,278,889,611,611,611,611,389,556,333,611,556,778,556,556,500,389,280,389,584,0,556,0,278,556,500,1E3,
556,556,333,1E3,667,333,1E3,0,611,0,0,278,278,500,500,350,556,1E3,333,1E3,556,333,944,0,500,667,278,333,556,556,556,556,280,556,333,737,370,556,584,0,737,333,400,584,0,0,333,611,556,278,333,0,365,556,834,834,834,611,722,722,722,722,722,722,1E3,722,667,667,667,667,278,278,278,278,722,722,778,778,778,778,778,584,778,722,722,722,722,667,667,611,556,556,556,556,556,556,889,556,556,556,556,556,278,278,278,278,611,611,611,611,611,611,611,584,611,611,611,611,611,556,611,556];
PDFFont.courierWidths=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,0,600,0,600,600,600,600,600,600,600,
600,600,600,600,0,600,0,0,600,600,600,600,600,600,600,600,600,600,600,600,0,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,0,600,600,600,600,0,0,600,600,600,600,600,0,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600];
PDFFont.symbolWidths=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,250,333,713,500,549,833,778,439,333,333,500,549,250,549,250,278,500,500,500,500,500,500,500,500,500,500,278,278,549,549,549,444,549,722,667,722,612,611,763,603,722,333,631,722,686,889,722,722,768,741,556,592,611,690,439,768,645,795,611,333,863,333,658,500,500,631,549,549,494,439,521,411,603,329,603,549,549,576,521,549,549,521,549,603,439,576,713,686,493,686,494,480,200,480,549,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,750,620,247,549,167,713,500,753,753,753,753,1042,987,603,987,603,400,549,411,549,549,713,494,460,549,549,549,549,1E3,603,1E3,658,823,686,795,987,768,768,823,768,768,713,713,713,713,713,713,713,768,713,790,790,890,823,549,250,713,603,603,1042,987,603,987,603,494,329,790,790,786,713,384,384,384,384,384,384,494,494,494,494,0,329,274,686,686,686,384,384,384,384,384,384,494,494,494,0];
PDFFont.zapfdingbatsWidths=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,278,974,961,974,980,719,789,790,791,690,960,939,549,855,911,933,911,945,974,755,846,762,761,571,677,763,760,759,754,494,552,537,577,692,786,788,788,790,793,794,816,823,789,841,823,833,816,831,923,744,723,749,790,792,695,776,768,792,759,707,708,682,701,826,815,789,789,707,687,696,689,786,787,713,791,785,791,873,761,762,762,759,759,892,892,788,784,438,138,277,415,392,392,668,668,0,390,390,317,317,276,276,509,
509,410,410,234,234,334,334,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,732,544,544,910,667,760,760,776,595,694,626,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,894,838,1016,458,748,924,748,918,927,928,928,834,873,828,924,924,917,930,931,463,883,836,836,867,867,696,696,874,0,874,760,946,771,865,771,888,967,888,831,873,927,970,918,0];PDFFont.prototype.getIdFont=function(){return"/F"+this.id};
PDFFont.prototype.getUnscaledTextWidth=function(a){for(var b=0,c=0;c<a.length;c++)b+=this.charWidths[a.charCodeAt(c)];return b};PDFFont.prototype.getTextWidth=function(a,b){return this.getUnscaledTextWidth(a)*b/1E3};
PDFFont.prototype.getText=function(a){this.addProperty(new PDFProperty("/Subtype","/Type1"));this.addProperty(new PDFProperty("/Name",this.getIdFont()));this.addProperty(new PDFProperty("/BaseFont","/"+this.fontName));"Symbol"!=this.fontName&&"ZapfDingbats"!=this.fontName&&this.addProperty(new PDFProperty("/Encoding","/WinAnsiEncoding"));this.addProperty(new PDFProperty("/FirstChar","0"));this.addProperty(new PDFProperty("/LastChar","255"));this.addProperty(new PDFProperty("/Widths","["+this.charWidths.join(" ")+
"]"));return PDFObject.prototype.getText.call(this,a)};PDFStream.prototype=new PDFObject;PDFStream.prototype.constructor=PDFStream;function PDFStream(){PDFObject.call(this);this.stream=""}PDFStream.prototype.addText=function(a){this.stream+=a};PDFStream.prototype.replaceText=function(a,b){this.stream=this.stream.replace(a,b)};PDFStream.prototype.getText=function(a){this.addProperty(new PDFProperty("/Length",this.stream.length));return PDFObject.prototype.getText.call(this,a)};
function PDFColor(a,b,c){void 0===b?(a=a.toUpperCase(),this.r=this.fromHex(a.substr(1,2)),this.g=this.fromHex(a.substr(3,2)),this.b=this.fromHex(a.substr(5,2))):(this.r=a,this.g=b,this.b=c)}PDFColor.prototype.fromHex=function(a){if(1==a.length)return"0"<=a&&"9">=a?a:a.charCodeAt(0)-65+10;for(var b=0,c=1,d=a.length-1;0<=d;d--)b+=this.fromHex(a.substr(d,1))*c,c*=16;return b};PDFColor.prototype.getFloat=function(a){return(a/255).toString()};
PDFColor.prototype.getFloatRGB=function(){return this.getFloat(this.r)+" "+this.getFloat(this.g)+" "+this.getFloat(this.b)};PDFImage.prototype=new PDFObject;PDFImage.prototype.constructor=PDFImage;function PDFImage(){PDFObject.call(this,"/XObject");this.loaded=!1}
PDFImage.prototype.scanCanvas=function(a){a=a.getImageData(0,0,this.width,this.height);for(var b=4*this.width,c=[],d=0;d<this.height;d++)for(var e=0;e<this.width;e++){var f=a.data[d*b+4*e],g=a.data[d*b+4*e+1],h=a.data[d*b+4*e+2];1>f&&(f=1);1>g&&(g=1);1>h&&(h=1);c.push(String.fromCharCode(parseInt(f,10)));c.push(String.fromCharCode(parseInt(g,10)));c.push(String.fromCharCode(parseInt(h,10)))}this.stream=c.join("");if(this.stream.length>this.width*this.height*3)throw new BytescoutPDFFatalError("bytescoutpdf.js error: utf-8 encoded image data!");
this.loaded=!0};PDFImage.prototype.writeImage=function(a){this.stream=a;this.loaded=!0};
PDFImage.prototype.getText=function(a){if(isNaN(this.width)||void 0==this.width||isNaN(this.height)||void 0==this.height)return void 0!=console&&console.log("image object: skipping writing of the object id="+this.id+" because width or height is NaN or undefined"),"";this.addProperty(new PDFProperty("/Subtype","/Image"));this.addProperty(new PDFProperty("/Width",this.width));this.addProperty(new PDFProperty("/Height",this.height));this.addProperty(new PDFProperty("/ColorSpace","/DeviceRGB"));"jpg"!=
this.format&&"jpeg"!=this.format||this.addProperty(new PDFProperty("/Filter","/DCTDecode"));this.addProperty(new PDFProperty("/BitsPerComponent",8));this.addProperty(new PDFProperty("/Length",this.stream.length));this.addProperty(new PDFProperty("/Name","/Im"+this.id));return PDFObject.prototype.getText.call(this,a)};function extractInfoFromBase64DataURI(a){return/^data:([\w]+?\/([\w]+?));base64,(.+?)$/g.exec(a)}PDFImageFromUrl.prototype=new PDFImage;PDFImageFromUrl.prototype.constructor=PDFImageFromUrl;
function PDFImageFromUrl(a,b,c){usejpeg=!0;jpegcompression=.95;"undefined"!==typeof b&&(usejpeg=b.ForceJPEGForImages,jpegcompression=b.JPEGQuality);var d=a.split(".").pop(),d=d.toLowerCase();usejpeg&&(d="jpg");PDFImage.call(this);this.fileName=a;this.badImage=this.loaded=!1;var e=this.img=new Image,f=this;c=document.createElement("CANVAS");c.style.visibility="hidden";c.style.position="absolute";document.body.appendChild(c);this.errorImage=function(){f.badImage=!0;if(void 0!=console&&(console.log("error while loading image from: "+
f.fileName),b.stopOnInvalidImages))throw new BytescoutPDFFatalError("CRITICAL ERROR: Image object is invalid, can not load from"+f.fileName);b.private_onload()};this.loadImage=function(){f.badImage=!1;f.width=e.width;f.height=e.height;f.format=d;c.width=f.width;c.height=f.height;var a=c.getContext("2d"),h=b.private_imageBackgroundColor;a.fillStyle="rgb("+h.r+","+h.g+","+h.b+")";a.fillRect(0,0,e.width,e.height);a.drawImage(e,0,0);usejpeg||"jpg"==d||"jpeg"==d?(1<jpegcompression&&(jpegcompression=1),
a=c.toDataURL("image/jpeg",jpegcompression),a=extractInfoFromBase64DataURI(a),imageData=atob(a[3]),PDFImage.prototype.writeImage.call(f,imageData)):PDFImage.prototype.scanCanvas.call(f,a);b.private_onload()};this.img.onload=this.loadImage;this.img.onerror=this.errorImage;this.img.src=this.fileName}PDFImageFromCanvas.prototype=new PDFImage;PDFImageFromCanvas.prototype.constructor=PDFImageFromCanvas;
function PDFImageFromCanvas(a,b){usejpeg=!0;jpegcompression=.95;"undefined"!==typeof b&&(usejpeg=b.ForceJPEGForImages,jpegcompression=b.JPEGQuality);PDFImage.call(this);this.loaded=!0;this.canvas=a;this.width=this.canvas.width;this.height=this.canvas.height;var c=this.canvas.getContext("2d");usejpeg&&(this.format="jpg");usejpeg?(1<jpegcompression&&(jpegcompression=1),c=this.canvas.toDataURL("image/jpeg",jpegcompression),c=extractInfoFromBase64DataURI(c),imageData=atob(c[3]),PDFImage.prototype.writeImage.call(this,
imageData)):PDFImage.prototype.scanCanvas.call(this,c)}function PDFImageInstance(a,b,c,d,e,f,g){this.x=a;this.y=b;this.alpha=d;this.angle=e;this.image=c;this.width=f;this.height=g}function PDFBox(a,b,c,d,e,f,g){this.page=a;this.x=b;this.y=c;this.width=d;this.height=e;this.align=f;this.interline=g;this.bottomY=this.offsetY=this.offsetX=0;this.bufferedLine=new PDFBufferedLine(this)}PDFBox.prototype.setAlign=function(a){this.align=a};PDFBox.prototype.setInterline=function(a){this.interline=a};
PDFBox.prototype.getX=function(){return this.x};PDFBox.prototype.canWrite=function(a){return this.offsetY+a<=this.height};PDFBox.prototype.textAdd=function(a,b,c,d,e){this.page.textAdd(this.x+a,this.y+b,c,d,void 0,e)};PDFBox.prototype.bufferedTextAdd=function(a,b,c){this.bufferedLine.bufferedTextAdd(a,b,this.offsetX,c);this.offsetX+=c;this.bottomY=this.offsetY+this.bufferedLine.maxFontSize+this.interline};
PDFBox.prototype.flush=function(a,b){if(this.bufferedLine.canFlush()){var c=this.bufferedLine.maxFontSize;this.bufferedLine.flush(a,b);this.offsetX=0;this.bottomY=this.offsetY+=c+this.interline}};PDFLink.prototype=new PDFObject;PDFLink.prototype.constructor=PDFLink;
function PDFLink(a,b){PDFObject.call(this,"/Annot");this.addProperty(new PDFProperty("/Subtype","/Link"));this.addProperty(new PDFProperty("/Rect","["+a.x+" "+a.y+" "+a.width+" "+a.height+"]"));this.addProperty(new PDFProperty("/Border","[0 0 0]"));this.addProperty(new PDFAction(b))}PDFAction.prototype=new PDFProperty;PDFAction.prototype.constructor=PDFAction;function PDFAction(a){this.link=a;PDFProperty.call(this,"/A")}
PDFAction.prototype.getText=function(a){var b=this.link;this.add(new PDFProperty("/Type","/Action"));if("http://"==b.substring(0,7)||"www."==b.substring(0,4))this.add(new PDFProperty("/S","/URI")),this.add(new PDFProperty("/URI","("+b+")"));else if("#"==b.substring(0,1)){this.add(new PDFProperty("/S","/GoTo"));var c,d=b.indexOf("#",1);if(-1==d){for(d=0;d<a.private_anchors.length&&a.private_anchors[d].name!=b;d++);if(d==a.private_anchors.length)throw"ERROR: anchor "+b+" not fount";c=a.private_anchors[d].page;
b=a.private_anchors[d].offset}else c=b.substring(1,d),b=b.substring(d+1);c=a.private_pages.getPage(c-1);this.add(new PDFProperty("/D","["+c.getRef()+" /XYZ 0 "+(c.h-b)+" 0]"))}else throw"ERROR: unknown link type "+b;return PDFProperty.prototype.getText.call(this,a)};function PDFHtmlParser(a,b,c){this.pdf=a;this.originalHtml=b;this.html=b.toLowerCase();this.ant=this.count=0;this.textState=c;this.states=[]}PDFHtmlParser.prototype.last=function(){return this.ant>=this.html.length};
PDFHtmlParser.prototype.getCurrentChar=function(){return this.ant};PDFHtmlParser.prototype.nextText=function(){if(this.last())return!1;this.pos=this.html.indexOf("<",this.ant);-1==this.pos&&(this.pos=this.html.length);var a=this.originalHtml.substring(this.ant,this.pos);this.ant=this.pos;return a=NormalizeTextStringToPDFString(a)};PDFHtmlParser.prototype.getAttrib=function(a,b){var c=a.indexOf(b+'="');if(-1!=c){var c=c+(b.length+2),d=a.indexOf('"',c);-1==d&&(d=a.length);return a.substring(c,d)}return!1};
PDFHtmlParser.prototype.nextTag=function(a){if(this.last())return!1;if("<b>"==this.html.substr(this.pos,3))this.pos+=3,this.textState.bold=!0,this.textState.font=void 0;else if("</b>"==this.html.substr(this.pos,4))this.pos+=4,this.textState.bold=!1,this.textState.font=void 0;else if("<i>"==this.html.substr(this.pos,3))this.pos+=3,this.textState.italic=!0,this.textState.font=void 0;else if("</i>"==this.html.substr(this.pos,4))this.pos+=4,this.textState.italic=!1,this.textState.font=void 0;else if("<u>"==
this.html.substr(this.pos,3))this.pos+=3,this.textState.underline=!0;else if("</u>"==this.html.substr(this.pos,4))this.pos+=4,this.textState.underline=!1;else if("<s>"==this.html.substr(this.pos,3))this.pos+=3,this.textState.strike=!0;else if("</s>"==this.html.substr(this.pos,4))this.pos+=4,this.textState.strike=!1;else if("<font"==this.html.substr(this.pos,5)){this.states.push(this.textState.clone());var b=this.html.indexOf(">",this.pos);-1==b&&(b=this.html.length);a=this.html.substring(this.pos+
5,b);var c=this.getAttrib(a,"face");c&&this.textState.fontSetName(c);if(c=this.getAttrib(a,"size"))this.textState.fontSize=parseInt(c);if(a=this.getAttrib(a,"color"))this.textState.color=new PDFColor(a);this.pos=b+1}else if("</font>"==this.html.substr(this.pos,7))this.pos+=7,this.textState.copyFrom(this.states.pop());else if("<a"==this.html.substr(this.pos,2)){b=this.html.indexOf(">",this.pos);-1!=b&&"/"==this.html.substr(b-1,1)||this.states.push(this.textState.clone());-1==b&&(b=this.html.length);
var c=this.html.substring(this.pos+3,b),d=this.getAttrib(c,"name");d&&this.pdf.addAnchor(d,this.pdf.private_currentPage.pageNumber,a.topY);if(a=this.getAttrib(c,"href"))this.textState.link=a;this.pos=b+1}else if("</a>"==this.html.substr(this.pos,4))this.pos+=4,this.textState.copyFrom(this.states.pop());else throw"html parser ERROR: unkown tag "+this.html.substr(this.pos,5)+"...";this.ant=this.pos;return!0};
function PDFTextState(){this.fontName="Helvetica";this.fontSize=12;this.strike=this.underline=this.italic=this.bold=!1;this.color=new PDFColor(0,0,0);this.link=this.font=void 0;this.linkColor=new PDFColor(0,0,255);this.linkUnderline=!0;this.alpha=1}PDFTextState.prototype.fontSetName=function(a){if(null!=PDFFont.getPDFName(a,this.bold,this.italic))this.fontName=a,this.font=void 0;else throw"The font ["+a+"] is not supported.";};PDFTextState.prototype.fontSetSize=function(a){this.fontSize=a};
PDFTextState.prototype.fontSetStyle=function(a,b,c){this.bold=a;this.italic=b;this.underline=c;this.font=void 0};PDFTextState.prototype.fontSetStyle=function(a,b,c,d){this.bold=a;this.italic=b;this.underline=c;this.strike=d;this.font=void 0};PDFTextState.prototype.setColor=function(a){this.color=a};PDFTextState.prototype.setAlpha=function(a){this.alpha=a};PDFTextState.prototype.getFontName=function(){return PDFFont.getPDFName(this.fontName,this.bold,this.italic)};
PDFTextState.prototype.setFont=function(a){this.font=a};PDFTextState.prototype.setLinkStyle=function(a,b){this.linkUnderline=a;this.linkColor=b};PDFTextState.prototype.clone=function(){var a=new PDFTextState;a.fontName=this.fontName;a.fontSize=this.fontSize;a.bold=this.bold;a.italic=this.italic;a.underline=this.underline;a.strike=this.strike;a.color=this.color;a.alpha=this.alpha;a.font=this.font;a.link=this.link;a.linkColor=this.linkColor;a.linkUnderline=this.linkUnderline;return a};
PDFTextState.prototype.copyFrom=function(a){this.fontName=a.fontName;this.fontSize=a.fontSize;this.bold=a.bold;this.italic=a.italic;this.underline=a.underline;this.strike=a.strike;this.color=a.color;this.alpha=a.alpha;this.font=a.font;this.link=a.link;this.linkColor=a.linkColor;this.linkUnderline=a.linkUnderline};
